<section
  role="region"
  aria-labelledby="creator-label"
  fxLayout="column"
  fxFlex="100%"
  fxLayoutGap="20px"
  class="num-margin-b-60"
>
  <h3>{{ 'BUILD_QUERY' | translate }}*</h3>
  <mat-card appearance="outlined">
    <mat-card-content fxLayout="column" fxFlex="100%">
      <p id="creator-label">
        {{ 'QUERIES.BUILD_QUERY_CONTENT' | translate }}
      </p>

      <num-button
        type="primary"
        icon="plus"
        class="num-margin-b-40"
        *numUserHasRole="[availableRoles.CriteriaEditor]"
        (singleClick)="openBuilderDialog(AqlBuilderDialogMode.Criteria)"
        data-test="aql-editor__aql-creator__open-builder-button"
        >{{ 'BUTTON.OPEN_QUERY_BUILDER' | translate }}</num-button
      >

      <div style="height: 300px" class="num-margin-b-40">
        <num-code-editor
          class="editor"
          style="height: 100%"
          [(value)]="aqlQuery"
          [formatObservable$]="formatObservable$"
          [validationObservable$]="validationObservable$"
          (editorInit)="onEditorInit($event)"
        ></num-code-editor>
      </div>

      <div class="button-row num-margin-b-20" fxLayout="row" fxLayoutGap="20px">
        <num-button
          type="primary"
          icon="align-left"
          (singleClick)="format()"
          data-test="aql-editor__aql-creator__format-button"
          >{{ 'BUTTON.FORMAT_QUERY' | translate }}</num-button
        >

        <num-button
          type="primary"
          icon="align-left"
          (singleClick)="validate(true)"
          data-test="aql-editor__aql-creator__validate-button"
          >{{ 'BUTTON.VALIDATE_QUERY' | translate }}</num-button
        >
      </div>

      <num-editor-determine-hits
        [isButtonDisabled]="!isValidForExecution || isExecutionLoading"
        [content]="determineHitsContent"
        (clicked)="determineHits()"
      ></num-editor-determine-hits>
    </mat-card-content>
  </mat-card>
</section>
